LFC Overlay & Camera Tracking SystemAn integrated broadcasting solution for fencing that features automated camera tracking, real-time scoring data, and QR-based athlete registration.üöÄ OverviewThis project automates the production of fencing livestreams by synchronizing three independent systems through an ESP-NOW wireless network and a Python-to-OBS bridge.Camera Tracking: A servo-mounted camera follows the fencers by measuring the distance of the Favero reels.Scoring Overlay: Real-time lights, score, and time data pulled directly from the Favero FA-05 scoring machine.QR Registration: A handheld scanner to instantly update fencer names and club affiliations in the broadcast.üèó System ArchitectureThe system utilizes ESP8266 (Wemos D1 Mini) microcontrollers communicating via ESP-NOW (low-latency protocol) to a central receiver connected to a laptop running OBS (Open Broadcaster Software).1. Camera Tracking SystemThe camera uses a quadrature encoder mounted on the Favero reel drum to calculate fencer positions.Hardware: * Servo: DS3218 (270¬∞ Digital Servo).Camera: 2K HD Manual Varifocal (2.8-12mm) USB Camera.Sensors: TCRT5000 IR sensors mounted in a custom 3D-printed optical holder.Logic: The system measures the length of the reel played out. By calculating the midpoint between two fencers, the servo rotates the camera to keep the action centered.Calibration: * Update center_line and hypotenuse in Wemos_Reel_Encoder.ino based on your camera's distance from the strip.Use the onboard potentiometer on the TCRT5000 to tune sensitivity until the white bars on the encoder ring are reliably detected.2. Scoring Machine IntegrationThe system intercepts the data stream from a Favero FA-05 via the RJ11 port.Wiring: Connect according to Schematic_Favero-Parser-and-Receiver_2025-12-16.pdf.Compatibility: Use Wemos D1 Mini versions with the CH340 chip for best results.Configuration: Assign a unique Box Name in the code if running multiple strips simultaneously.3. QR Code ScannerFor rapid fencer changes during tournaments.Hardware: Waveshare Round 2D Code Scanner Module.Function: Scans fencer/club info and transmits it wirelessly to the OBS bridge to update text sources instantly.üíª Software & OBS IntegrationThe Python Bridge (Favero_OBS_Bridge.py)This script acts as the "brain." It listens to the Serial port for data from the Wemos receiver and pushes it to OBS via Websockets.Setup:Install dependencies: pip install obsws-python pyserialUpdate the script with your OBS Websocket password and local image asset paths.Import the provided OBS scene: Camera_Tracking_Favero_Overlay.json.üìê Mathematics of TrackingThe system assumes the camera is placed at a fixed offset from the center of the strip. The angle $\theta$ for the servo is calculated using:$$\theta = \arctan\left(\frac{\text{Midpoint Distance}}{\text{Camera Offset}}\right)$$Where the midpoint is derived from the quadrature pulses converted to linear distance ($L$ and $R$).üõ† Fabrication FilesPCBs: Gerber files are located in Gerber_Favero_Optical_Encoder_PCB.zip (Compatible with PCBWay/JLCPCB).3D Prints:Optical Sensor HolderQR Scanner Housing‚ö†Ô∏è Known Issues / TroubleshootingEncoder Slip: If the encoder ring on the Favero drum is loose, the camera may "drift." Ensure it is flush and the counts return to zero when fully retracted.Ambient Light: Calibrate IR sensors in lighting conditions similar to your venue to avoid false triggers.
